!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("microsoftTeams",[],n):"object"==typeof exports?exports.microsoftTeams=n():e.microsoftTeams=n()}(window,function(){return function(t){var a={};function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=a,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(n,e){if(1&e&&(n=r(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var a in n)r.d(t,a,function(e){return n[e]}.bind(null,a));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=13)}([function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalVars=void 0;var a=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.additionalValidOriginsRegexp=null,e.initializeCallbacks=[],e.isFramelessWindow=!1,e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.handlers={},e.callbacks={},e.printCapabilityEnabled=!1,e}();n.GlobalVars=a},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sendMessageEventToChild=n.sendMessageRequestToParent=n.waitForMessageQueue=n.processAdditionalValidOrigins=n.handleParentMessage=n.processMessage=n.isAPISupportedByPlatform=n.ensureInitialized=void 0;var a=t(6),r=t(4),o=t(0),i=t(3);function s(e,n){return(!o.GlobalVars.currentWindow||e!==o.GlobalVars.currentWindow)&&(o.GlobalVars.currentWindow&&o.GlobalVars.currentWindow.location&&n&&n===o.GlobalVars.currentWindow.location.origin||!!(r.validOriginRegExp.test(n.toLowerCase())||o.GlobalVars.additionalValidOriginsRegexp&&o.GlobalVars.additionalValidOriginsRegexp.test(n.toLowerCase())))}function l(e,n){!o.GlobalVars.parentWindow||o.GlobalVars.parentWindow.closed||e===o.GlobalVars.parentWindow?(o.GlobalVars.parentWindow=e,o.GlobalVars.parentOrigin=n):o.GlobalVars.childWindow&&!o.GlobalVars.childWindow.closed&&e!==o.GlobalVars.childWindow||(o.GlobalVars.childWindow=e,o.GlobalVars.childOrigin=n),o.GlobalVars.parentWindow&&o.GlobalVars.parentWindow.closed&&(o.GlobalVars.parentWindow=null,o.GlobalVars.parentOrigin=null),o.GlobalVars.childWindow&&o.GlobalVars.childWindow.closed&&(o.GlobalVars.childWindow=null,o.GlobalVars.childOrigin=null),g(o.GlobalVars.parentWindow),g(o.GlobalVars.childWindow)}function u(e){var n,t;"id"in e.data&&"number"==typeof e.data.id?(t=e.data,(n=o.GlobalVars.callbacks[t.id])&&(n.apply(null,t.args),delete o.GlobalVars.callbacks[t.id])):"func"in e.data&&"string"==typeof e.data.func&&(t=e.data,(e=o.GlobalVars.handlers[t.func])&&e.apply(this,t.args))}function d(e){var t,n;"id"in e.data&&"func"in e.data&&((e=(t=e.data).func?o.GlobalVars.handlers[t.func]:null)?void 0!==(n=e.apply(this,t.args))&&b(t.id,Array.isArray(n)?n:[n]):(n=p(t.func,t.args),o.GlobalVars.callbacks[n]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];o.GlobalVars.childWindow&&b(t.id,e)}))}function c(e){return e===o.GlobalVars.parentWindow?o.GlobalVars.parentMessageQueue:e===o.GlobalVars.childWindow?o.GlobalVars.childMessageQueue:[]}function f(e){return e===o.GlobalVars.parentWindow?o.GlobalVars.parentOrigin:e===o.GlobalVars.childWindow?o.GlobalVars.childOrigin:null}function g(e){for(var n=f(e),t=c(e);e&&n&&0<t.length;)e.postMessage(t.shift(),n)}function p(e,n){var t=o.GlobalVars.parentWindow,e=h(e,n);return o.GlobalVars.isFramelessWindow?o.GlobalVars.currentWindow&&o.GlobalVars.currentWindow.nativeInterface&&o.GlobalVars.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(e)):(n=f(t),t&&n?t.postMessage(e,n):c(t).push(e)),e.id}function b(e,n){var t=o.GlobalVars.childWindow,e=v(e,n),n=f(t);t&&n&&t.postMessage(e,n)}function m(e,n){var t=o.GlobalVars.childWindow,e=C(e,n),n=f(t);t&&n?t.postMessage(e,n):c(t).push(e)}function h(e,n){return{id:o.GlobalVars.nextMessageId++,func:e,args:n||[]}}function v(e,n){return{id:e,args:n||[]}}function C(e,n){return{func:e,args:n||[]}}o.GlobalVars.handlers.themeChange=function(e){o.GlobalVars.themeChangeHandler&&o.GlobalVars.themeChangeHandler(e);o.GlobalVars.childWindow&&m("themeChange",[e])},o.GlobalVars.handlers.fullScreenChange=function(e){o.GlobalVars.fullScreenChangeHandler&&o.GlobalVars.fullScreenChangeHandler(e)},o.GlobalVars.handlers.backButtonPress=function(){o.GlobalVars.backButtonPressHandler&&o.GlobalVars.backButtonPressHandler()||a.navigateBack()},o.GlobalVars.handlers.load=function(e){o.GlobalVars.loadHandler&&o.GlobalVars.loadHandler(e);o.GlobalVars.childWindow&&m("load",[e])},o.GlobalVars.handlers.beforeUnload=function(){function e(){p("readyToUnload",[])}o.GlobalVars.beforeUnloadHandler&&o.GlobalVars.beforeUnloadHandler(e)||e()},o.GlobalVars.handlers.changeSettings=function(){o.GlobalVars.changeSettingsHandler&&o.GlobalVars.changeSettingsHandler()},o.GlobalVars.handlers.startConversation=function(e,n,t,a){o.GlobalVars.onStartConversationHandler&&o.GlobalVars.onStartConversationHandler({subEntityId:e,conversationId:n,channelId:t,entityId:a})},o.GlobalVars.handlers.closeConversation=function(e,n,t,a){o.GlobalVars.onCloseConversationHandler&&o.GlobalVars.onCloseConversationHandler({subEntityId:e,conversationId:n,channelId:t,entityId:a})},o.GlobalVars.handlers.appButtonClick=function(){o.GlobalVars.appButtonClickHandler&&o.GlobalVars.appButtonClickHandler()},o.GlobalVars.handlers.appButtonHoverEnter=function(){o.GlobalVars.appButtonHoverEnterHandler&&o.GlobalVars.appButtonHoverEnterHandler()},o.GlobalVars.handlers.appButtonHoverLeave=function(){o.GlobalVars.appButtonHoverLeaveHandler&&o.GlobalVars.appButtonHoverLeaveHandler()},n.ensureInitialized=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(!o.GlobalVars.initializeCalled)throw new Error("The library has not yet been initialized");if(alert("!! ExpectedFrameContexts: "+JSON.stringify(e)),alert("!! GlobalVars.frameContext: "+JSON.stringify(o.GlobalVars.frameContext)),o.GlobalVars.frameContext&&e&&0<e.length){for(var t=!1,a=0;a<e.length;a++)if(e[a]===o.GlobalVars.frameContext){t=!0;break}if(!t)throw new Error("This call is not allowed in the '"+o.GlobalVars.frameContext+"' context")}},n.isAPISupportedByPlatform=function(e){return void 0===e&&(e=r.defaultSDKVersionForCompatCheck),e=i.compareSDKVersions(o.GlobalVars.clientSupportedSDKVersion,e),!isNaN(e)&&0<=e},n.processMessage=function(e){var n,t;e&&e.data&&"object"==typeof e.data&&(s(n=e.source||e.originalEvent&&e.originalEvent.source,t=e.origin||e.originalEvent&&e.originalEvent.origin)&&(l(n,t),n===o.GlobalVars.parentWindow?u(e):n===o.GlobalVars.childWindow&&d(e)))},n.handleParentMessage=u,n.processAdditionalValidOrigins=function(e){var e=o.GlobalVars.additionalValidOrigins.concat(e.filter(function(e){return"string"==typeof e&&r.userOriginUrlValidationRegExp.test(e)})),n={},e=e.filter(function(e){return!n[e]&&(n[e]=!0)});o.GlobalVars.additionalValidOrigins=e,0<o.GlobalVars.additionalValidOrigins.length?o.GlobalVars.additionalValidOriginsRegexp=i.generateRegExpFromUrls(o.GlobalVars.additionalValidOrigins):o.GlobalVars.additionalValidOriginsRegexp=null},n.waitForMessageQueue=function(e,n){var t=o.GlobalVars.currentWindow.setInterval(function(){0===c(e).length&&(clearInterval(t),n())},100)},n.sendMessageRequestToParent=p,n.sendMessageEventToChild=m},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ChannelType=n.TaskModuleDimension=n.UserTeamRole=n.TeamType=n.FrameContexts=n.HostClientType=void 0,function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.rigel="rigel"}(n.HostClientType||(n.HostClientType={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage"}(n.FrameContexts||(n.FrameContexts={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(n.TeamType||(n.TeamType={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(n.UserTeamRole||(n.UserTeamRole={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(n.TaskModuleDimension||(n.TaskModuleDimension={})),function(e){e.Regular="Regular",e.Private="Private"}(n.ChannelType||(n.ChannelType={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.generateGUID=n.compareSDKVersions=n.getGenericOnCompleteHandler=n.generateRegExpFromUrls=void 0;var a=t(16);function r(e){for(var n="^",t=e.split("."),a=0;a<t.length;a++)n+=(0<a?"[.]":"")+t[a].replace("*","[^/^.]+");return n+="$"}n.generateRegExpFromUrls=function(e){for(var n="",t=0;t<e.length;t++)n+=(0===t?"":"|")+r(e[t]);return new RegExp(n)},n.getGenericOnCompleteHandler=function(t){return function(e,n){if(!e)throw new Error(t||n)}},n.compareSDKVersions=function(e,n){if("string"!=typeof e||"string"!=typeof n)return NaN;var t=e.split("."),a=n.split(".");function r(e){return/^\d+$/.test(e)}if(!t.every(r)||!a.every(r))return NaN;for(;t.length<a.length;)t.push("0");for(;a.length<t.length;)a.push("0");for(var o=0;o<t.length;++o)if(t[o]!=a[o])return t[o]>a[o]?1:-1;return 0},n.generateGUID=function(){return a.v4()}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.userOriginUrlValidationRegExp=n.validOriginRegExp=n.validOrigins=n.defaultSDKVersionForCompatCheck=n.version=void 0;t=t(3);n.version="1.7.0",n.defaultSDKVersionForCompatCheck="1.6.0",n.validOrigins=["https://teams.microsoft.com","https://teams.microsoft.us","https://gov.teams.microsoft.us","https://dod.teams.microsoft.us","https://int.teams.microsoft.com","https://devspaces.skype.com","https://ssauth.skype.com","https://local.teams.office.com","https://local.teams.office.com:8080","https://msft.spoppe.com","https://*.sharepoint.com","https://*.sharepoint-df.com","https://*.sharepointonline.com","https://outlook.office.com","https://outlook-sdf.office.com","https://*.teams.microsoft.com","https://www.office.com","https://word.office.com","https://excel.office.com","https://powerpoint.office.com","https://www.officeppe.com","https://*.www.office.com","http://127.0.0.1:5000"],n.validOriginRegExp=t.generateRegExpFromUrls(n.validOrigins),n.userOriginUrlValidationRegExp=/^https\:\/\//},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ErrorCode=void 0,function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(n.ErrorCode||(n.ErrorCode={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.navigateBack=n.navigateCrossDomain=n.navigateToTab=n.returnFocus=void 0;var a=t(1),r=t(0),o=t(3),i=t(2);n.returnFocus=function(e){a.ensureInitialized(i.FrameContexts.content),a.sendMessageRequestToParent("returnFocus",[e])},n.navigateToTab=function(e,n){a.ensureInitialized(),e=a.sendMessageRequestToParent("navigateToTab",[e]),r.GlobalVars.callbacks[e]=n||o.getGenericOnCompleteHandler("Invalid internalTabInstanceId and/or channelId were/was provided")},n.navigateCrossDomain=function(e,n){a.ensureInitialized(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.settings,i.FrameContexts.remove,i.FrameContexts.task,i.FrameContexts.stage),e=a.sendMessageRequestToParent("navigateCrossDomain",[e]),r.GlobalVars.callbacks[e]=n||o.getGenericOnCompleteHandler("Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.")},n.navigateBack=function(e){a.ensureInitialized();var n=a.sendMessageRequestToParent("navigateBack",[]);r.GlobalVars.callbacks[n]=e||o.getGenericOnCompleteHandler("Back navigation is not supported in the current client or context.")}},function(e,n){var t,a,r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);r?(t=new Uint8Array(16),e.exports=function(){return r(t),t}):(a=new Array(16),e.exports=function(){for(var e,n=0;n<16;n++)0==(3&n)&&(e=4294967296*Math.random()),a[n]=e>>>((3&n)<<3)&255;return a})},function(e,n){for(var t=[],a=0;a<256;++a)t[a]=(a+256).toString(16).substr(1);e.exports=function(e,n){return n=n||0,[t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],"-",t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]],t[e[n++]]].join("")}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.logs=void 0;var a=t(1),r=t(0);!function(e){r.GlobalVars.handlers["log.request"]=function(){{var e;r.GlobalVars.getLogHandler&&(e=r.GlobalVars.getLogHandler(),a.sendMessageRequestToParent("log.receive",[e]))}},e.registerGetLogHandler=function(e){a.ensureInitialized(),(r.GlobalVars.getLogHandler=e)&&a.sendMessageRequestToParent("registerHandler",["log.request"])}}(n.logs||(n.logs={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.settings=void 0;var o=t(1),i=t(0),s=t(2),l=t(3);!function(e){var n,t;i.GlobalVars.handlers["settings.save"]=function(e){e=new a(e);n?n(e):e.notifySuccess()},i.GlobalVars.handlers["settings.remove"]=function(){var e=new r;t?t(e):e.notifySuccess()},e.setValidityState=function(e){o.ensureInitialized(s.FrameContexts.settings,s.FrameContexts.remove),o.sendMessageRequestToParent("settings.setValidityState",[e])},e.getSettings=function(e){o.ensureInitialized(s.FrameContexts.content,s.FrameContexts.settings,s.FrameContexts.remove);var n=o.sendMessageRequestToParent("settings.getSettings");i.GlobalVars.callbacks[n]=e},e.setSettings=function(e,n){o.ensureInitialized(s.FrameContexts.content,s.FrameContexts.settings),e=o.sendMessageRequestToParent("settings.setSettings",[e]),i.GlobalVars.callbacks[e]=n||l.getGenericOnCompleteHandler()},e.registerOnSaveHandler=function(e){o.ensureInitialized(s.FrameContexts.settings),(n=e)&&o.sendMessageRequestToParent("registerHandler",["save"])},e.registerOnRemoveHandler=function(e){o.ensureInitialized(s.FrameContexts.remove),(t=e)&&o.sendMessageRequestToParent("registerHandler",["remove"])};var a=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),o.sendMessageRequestToParent("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),o.sendMessageRequestToParent("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();var r=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),o.sendMessageRequestToParent("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),o.sendMessageRequestToParent("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}()}(n.settings||(n.settings={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ParentAppWindow=n.ChildAppWindow=void 0;var a=t(1),r=t(0),o=t(2),i=t(3),t=function(){function e(){}return e.prototype.postMessage=function(e,n){a.ensureInitialized();e=a.sendMessageRequestToParent("messageForChild",[e]);r.GlobalVars.callbacks[e]=n||i.getGenericOnCompleteHandler()},e.prototype.addEventListener=function(e,n){"message"===e&&(r.GlobalVars.handlers.messageForParent=n)},e}();n.ChildAppWindow=t;t=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,n){a.ensureInitialized(o.FrameContexts.task);e=a.sendMessageRequestToParent("messageForParent",[e]);r.GlobalVars.callbacks[e]=n||i.getGenericOnCompleteHandler()},e.prototype.addEventListener=function(e,n){"message"===e&&(r.GlobalVars.handlers.messageForChild=n)},e}();n.ParentAppWindow=t},function(e,n,t){"use strict";var a=this&&this.__extends||function(){var a=function(e,n){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])})(e,n)};return function(e,n){function t(){this.constructor=e}a(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();Object.defineProperty(n,"__esModule",{value:!0}),n.media=void 0;var l=t(0),u=t(5),d=t(1),c=t(2),i=t(3),f=t(29);!function(e){var o="1.8.0";!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var n=function(){return function(){}}();e.File=n,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");var n;d.ensureInitialized(c.FrameContexts.content,c.FrameContexts.task),l.GlobalVars.isFramelessWindow?d.isAPISupportedByPlatform("1.7.0")?(n=d.sendMessageRequestToParent("captureImage"),l.GlobalVars.callbacks[n]=e):e({errorCode:u.ErrorCode.OLD_PLATFORM},void 0):e({errorCode:u.ErrorCode.NOT_SUPPORTED_ON_PLATFORM},void 0)};var s=function(t){function e(e){void 0===e&&(e=null);var n=t.call(this)||this;return e&&(n.content=e.content,n.format=e.format,n.mimeType=e.mimeType,n.name=e.name,n.preview=e.preview,n.size=e.size),n}return a(e,t),e.prototype.getMedia=function(t){if(!t)throw new Error("[get Media] Callback cannot be null");var a,r,e,n;d.ensureInitialized(c.FrameContexts.content,c.FrameContexts.task),d.isAPISupportedByPlatform(o)?f.validateGetMediaInputs(this.mimeType,this.format,this.content)?(a=i.generateGUID(),r={mediaMimeType:this.mimeType,assembleAttachment:[]},e=[a,this.content],this.content&&t&&d.sendMessageRequestToParent("getMedia",e),l.GlobalVars.handlers["getMedia"+a]=function(e){var n;t&&((n=JSON.parse(e)).error?(t(n.error,null),l.GlobalVars.handlers["getMedia"+a]=null):n.mediaChunk?n.mediaChunk.chunkSequence<=0?(e=f.createFile(r.assembleAttachment,r.mediaMimeType),t(n.error,e),l.GlobalVars.handlers["getMedia"+a]=null):(n=f.decodeAttachment(n.mediaChunk,r.mediaMimeType),r.assembleAttachment.push(n)):(t({errorCode:u.ErrorCode.INTERNAL_ERROR,message:"data receieved is null"},null),l.GlobalVars.handlers["getMedia"+a]=null))}):(n={errorCode:u.ErrorCode.INVALID_ARGUMENTS},t(n,null)):(n={errorCode:u.ErrorCode.OLD_PLATFORM},t(n,null))},e}(n);e.Media=s,function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Audio=4]="Audio"}(e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),e.selectMedia=function(e,i){if(!i)throw new Error("[select Media] Callback cannot be null");var n;d.ensureInitialized(c.FrameContexts.content,c.FrameContexts.task),d.isAPISupportedByPlatform(o)?f.validateSelectMediaInputs(e)?(e=[e],e=d.sendMessageRequestToParent("selectMedia",e),l.GlobalVars.callbacks[e]=function(e,n){if(n){for(var t=[],a=0,r=n;a<r.length;a++){var o=r[a];t.push(new s(o))}i(e,t)}else i(e,null)}):(n={errorCode:u.ErrorCode.INVALID_ARGUMENTS},i(n,null)):(n={errorCode:u.ErrorCode.OLD_PLATFORM},i(n,null))},e.viewImages=function(e,n){if(!n)throw new Error("[view images] Callback cannot be null");d.ensureInitialized(c.FrameContexts.content,c.FrameContexts.task),d.isAPISupportedByPlatform(o)?f.validateViewImagesInput(e)?(e=[e],e=d.sendMessageRequestToParent("viewImages",e),l.GlobalVars.callbacks[e]=n):n({errorCode:u.ErrorCode.INVALID_ARGUMENTS}):n({errorCode:u.ErrorCode.OLD_PLATFORM})}}(n.media||(n.media={}))},function(e,n,t){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,n,t,a){void 0===a&&(a=t),Object.defineProperty(e,a,{enumerable:!0,get:function(){return n[t]}})}:function(e,n,t,a){void 0===a&&(a=t),e[a]=n[t]}),r=this&&this.__exportStar||function(e,n){for(var t in e)"default"===t||n.hasOwnProperty(t)||a(n,e,t)};Object.defineProperty(n,"__esModule",{value:!0}),r(t(14),n),r(t(24),n)},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t(15);Object.defineProperty(n,"bot",{enumerable:!0,get:function(){return a.bot}});var r=t(19);Object.defineProperty(n,"menus",{enumerable:!0,get:function(){return r.menus}});var o=t(9);Object.defineProperty(n,"logs",{enumerable:!0,get:function(){return o.logs}});var i=t(20);Object.defineProperty(n,"NotificationTypes",{enumerable:!0,get:function(){return i.NotificationTypes}});var s=t(21);Object.defineProperty(n,"enterFullscreen",{enumerable:!0,get:function(){return s.enterFullscreen}}),Object.defineProperty(n,"exitFullscreen",{enumerable:!0,get:function(){return s.exitFullscreen}}),Object.defineProperty(n,"getChatMembers",{enumerable:!0,get:function(){return s.getChatMembers}}),Object.defineProperty(n,"getConfigSetting",{enumerable:!0,get:function(){return s.getConfigSetting}}),Object.defineProperty(n,"getUserJoinedTeams",{enumerable:!0,get:function(){return s.getUserJoinedTeams}}),Object.defineProperty(n,"openFilePreview",{enumerable:!0,get:function(){return s.openFilePreview}}),Object.defineProperty(n,"sendCustomMessage",{enumerable:!0,get:function(){return s.sendCustomMessage}}),Object.defineProperty(n,"showNotification",{enumerable:!0,get:function(){return s.showNotification}}),Object.defineProperty(n,"sendCustomEvent",{enumerable:!0,get:function(){return s.sendCustomEvent}}),Object.defineProperty(n,"registerCustomHandler",{enumerable:!0,get:function(){return s.registerCustomHandler}}),Object.defineProperty(n,"uploadCustomApp",{enumerable:!0,get:function(){return s.uploadCustomApp}});var l=t(22);Object.defineProperty(n,"conversations",{enumerable:!0,get:function(){return l.conversations}});var u=t(23);Object.defineProperty(n,"meetingRoom",{enumerable:!0,get:function(){return u.meetingRoom}})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.bot=void 0;var r=t(0),o=t(1);!function(e){e.sendQuery=function(e,t,a){o.ensureInitialized(),e=o.sendMessageRequestToParent("bot.executeQuery",[e]),r.GlobalVars.callbacks[e]=function(e,n){(e?t:a)(n)}},e.getSupportedCommands=function(t,a){o.ensureInitialized();var e=o.sendMessageRequestToParent("bot.getSupportedCommands");r.GlobalVars.callbacks[e]=function(e,n){(e?t:a)(n)}},e.authenticate=function(e,t,a){o.ensureInitialized(),e=o.sendMessageRequestToParent("bot.authenticate",[e]),r.GlobalVars.callbacks[e]=function(e,n){(e?t:a)(n)}},function(e){e.Results="Results",e.Auth="Auth"}(e.ResponseType||(e.ResponseType={}))}(n.bot||(n.bot={}))},function(e,n,t){var a=t(17),r=t(18),t=r;t.v1=a,t.v4=r,e.exports=t},function(e,n,t){var d,c,f=t(7),g=t(8),p=0,b=0;e.exports=function(e,n,t){var a=n&&t||0,r=n||[],o=(e=e||{}).node||d,i=void 0!==e.clockseq?e.clockseq:c;null!=o&&null!=i||(l=f(),null==o&&(o=d=[1|l[0],l[1],l[2],l[3],l[4],l[5]]),null==i&&(i=c=16383&(l[6]<<8|l[7])));var s=void 0!==e.msecs?e.msecs:(new Date).getTime(),t=void 0!==e.nsecs?e.nsecs:b+1,l=s-p+(t-b)/1e4;if(l<0&&void 0===e.clockseq&&(i=i+1&16383),(l<0||p<s)&&void 0===e.nsecs&&(t=0),1e4<=t)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");p=s,c=i,t=(1e4*(268435455&(s+=122192928e5))+(b=t))%4294967296,r[a++]=t>>>24&255,r[a++]=t>>>16&255,r[a++]=t>>>8&255,r[a++]=255&t,s=s/4294967296*1e4&268435455,r[a++]=s>>>8&255,r[a++]=255&s,r[a++]=s>>>24&15|16,r[a++]=s>>>16&255,r[a++]=i>>>8|128,r[a++]=255&i;for(var u=0;u<6;++u)r[a+u]=o[u];return n||g(r)}},function(e,n,t){var i=t(7),s=t(8);e.exports=function(e,n,t){var a=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||i)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n)for(var o=0;o<16;++o)n[a+o]=r[o];return n||s(r)}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.menus=void 0;var o=t(1),i=t(0);!function(e){var t,a,r,n=function(){return function(){this.enabled=!0,this.selected=!1}}();e.MenuItem=n,function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),i.GlobalVars.handlers.navBarMenuItemPress=function(e){t&&t(e)||(o.ensureInitialized(),o.sendMessageRequestToParent("handleNavBarMenuItemPress",[e]))},i.GlobalVars.handlers.actionMenuItemPress=function(e){a&&a(e)||(o.ensureInitialized(),o.sendMessageRequestToParent("handleActionMenuItemPress",[e]))},i.GlobalVars.handlers.setModuleView=function(e){r&&r(e)||(o.ensureInitialized(),o.sendMessageRequestToParent("viewConfigItemPress",[e]))},e.setUpViews=function(e,n){o.ensureInitialized(),r=n,o.sendMessageRequestToParent("setUpViews",[e])},e.setNavBarMenu=function(e,n){o.ensureInitialized(),t=n,o.sendMessageRequestToParent("setNavBarMenu",[e])},e.showActionMenu=function(e,n){o.ensureInitialized(),a=n,o.sendMessageRequestToParent("showActionMenu",[e])}}(n.menus||(n.menus={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.NotificationTypes=void 0,function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(n.NotificationTypes||(n.NotificationTypes={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.getConfigSetting=n.getChatMembers=n.registerCustomHandler=n.sendCustomEvent=n.sendCustomMessage=n.uploadCustomApp=n.showNotification=n.openFilePreview=n.exitFullscreen=n.enterFullscreen=n.getUserJoinedTeams=void 0;var r=t(1),o=t(0),a=t(2),i=t(3);n.getUserJoinedTeams=function(e,n){r.ensureInitialized(),n=r.sendMessageRequestToParent("getUserJoinedTeams",[n]),o.GlobalVars.callbacks[n]=e},n.enterFullscreen=function(){r.ensureInitialized(a.FrameContexts.content),r.sendMessageRequestToParent("enterFullscreen",[])},n.exitFullscreen=function(){r.ensureInitialized(a.FrameContexts.content),r.sendMessageRequestToParent("exitFullscreen",[])},n.openFilePreview=function(e){r.ensureInitialized(a.FrameContexts.content),e=[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId],r.sendMessageRequestToParent("openFilePreview",e)},n.showNotification=function(e){r.ensureInitialized(a.FrameContexts.content),e=[e.message,e.notificationType],r.sendMessageRequestToParent("showNotification",e)},n.uploadCustomApp=function(e,n){r.ensureInitialized(),e=r.sendMessageRequestToParent("uploadCustomApp",[e]),o.GlobalVars.callbacks[e]=n||i.getGenericOnCompleteHandler()},n.sendCustomMessage=function(e,n,t){return r.ensureInitialized(),n=r.sendMessageRequestToParent(e,n),"function"==typeof t&&(o.GlobalVars.callbacks[n]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.apply(null,e)}),n},n.sendCustomEvent=function(e,n){if(r.ensureInitialized(),!o.GlobalVars.childWindow)throw new Error("The child window has not yet been initialized or is not present");r.sendMessageEventToChild(e,n)},n.registerCustomHandler=function(e,t){var a=this;r.ensureInitialized(),o.GlobalVars.handlers[e]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(a,e)}},n.getChatMembers=function(e){r.ensureInitialized();var n=r.sendMessageRequestToParent("getChatMembers");o.GlobalVars.callbacks[n]=e},n.getConfigSetting=function(e,n){r.ensureInitialized(),n=r.sendMessageRequestToParent("getConfigSetting",[n]),o.GlobalVars.callbacks[n]=e}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.conversations=void 0;var a=t(1),r=t(0),o=t(2);!function(e){e.openConversation=function(e){a.ensureInitialized(o.FrameContexts.content);var n=a.sendMessageRequestToParent("conversations.openConversation",[{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId}]);r.GlobalVars.onCloseConversationHandler=e.onCloseConversation,r.GlobalVars.onStartConversationHandler=e.onStartConversation,r.GlobalVars.callbacks[n]=function(e,n){if(!e)throw new Error(n)}},e.closeConversation=function(){a.ensureInitialized(o.FrameContexts.content),a.sendMessageRequestToParent("conversations.closeConversation"),r.GlobalVars.onCloseConversationHandler=null,r.GlobalVars.onStartConversationHandler=null}}(n.conversations||(n.conversations={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.meetingRoom=void 0;var a=t(1),r=t(0);!function(e){!function(e){e.toggleMute="toggleMute",e.toggleCamera="toggleCamera",e.toggleCaptions="toggleCaptions",e.volume="volume",e.showVideoGallery="showVideoGallery",e.showContent="showContent",e.showVideoGalleryAndContent="showVideoGalleryAndContent",e.showLargeGallery="showLargeGallery",e.showTogether="showTogether",e.leaveMeeting="leaveMeeting"}(e.Capability||(e.Capability={})),r.GlobalVars.handlers["meetingRoom.meetingRoomCapabilitiesUpdate"]=function(e){null!=r.GlobalVars.meetingRoomCapabilitiesUpdateHandler&&(a.ensureInitialized(),r.GlobalVars.meetingRoomCapabilitiesUpdateHandler(e))},r.GlobalVars.handlers["meetingRoom.meetingRoomStatesUpdate"]=function(e){null!=r.GlobalVars.meetingRoomStatesUpdateHandler&&(a.ensureInitialized(),r.GlobalVars.meetingRoomStatesUpdateHandler(e))},e.getPairedMeetingRoomInfo=function(e){a.ensureInitialized();var n=a.sendMessageRequestToParent("meetingRoom.getPairedMeetingRoomInfo");r.GlobalVars.callbacks[n]=e},e.sendCommandToPairedMeetingRoom=function(e,n){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(!n)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Callback cannot be null");a.ensureInitialized(),e=a.sendMessageRequestToParent("meetingRoom.sendCommandToPairedMeetingRoom",[e]),r.GlobalVars.callbacks[e]=n},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");a.ensureInitialized(),(r.GlobalVars.meetingRoomCapabilitiesUpdateHandler=e)&&a.sendMessageRequestToParent("registerHandler",["meetingRoom.meetingRoomCapabilitiesUpdate"])},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");a.ensureInitialized(),(r.GlobalVars.meetingRoomStatesUpdateHandler=e)&&a.sendMessageRequestToParent("registerHandler",["meetingRoom.meetingRoomStatesUpdate"])}}(n.meetingRoom||(n.meetingRoom={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=t(25);Object.defineProperty(n,"appInitialization",{enumerable:!0,get:function(){return a.appInitialization}});var r=t(26);Object.defineProperty(n,"authentication",{enumerable:!0,get:function(){return r.authentication}});var o=t(2);Object.defineProperty(n,"FrameContexts",{enumerable:!0,get:function(){return o.FrameContexts}}),Object.defineProperty(n,"HostClientType",{enumerable:!0,get:function(){return o.HostClientType}}),Object.defineProperty(n,"TaskModuleDimension",{enumerable:!0,get:function(){return o.TaskModuleDimension}}),Object.defineProperty(n,"TeamType",{enumerable:!0,get:function(){return o.TeamType}}),Object.defineProperty(n,"UserTeamRole",{enumerable:!0,get:function(){return o.UserTeamRole}}),Object.defineProperty(n,"ChannelType",{enumerable:!0,get:function(){return o.ChannelType}});var i=t(5);Object.defineProperty(n,"ErrorCode",{enumerable:!0,get:function(){return i.ErrorCode}});var s=t(27);Object.defineProperty(n,"enablePrintCapability",{enumerable:!0,get:function(){return s.enablePrintCapability}}),Object.defineProperty(n,"executeDeepLink",{enumerable:!0,get:function(){return s.executeDeepLink}}),Object.defineProperty(n,"getContext",{enumerable:!0,get:function(){return s.getContext}}),Object.defineProperty(n,"getMruTabInstances",{enumerable:!0,get:function(){return s.getMruTabInstances}}),Object.defineProperty(n,"getTabInstances",{enumerable:!0,get:function(){return s.getTabInstances}}),Object.defineProperty(n,"initialize",{enumerable:!0,get:function(){return s.initialize}}),Object.defineProperty(n,"initializeWithFrameContext",{enumerable:!0,get:function(){return s.initializeWithFrameContext}}),Object.defineProperty(n,"print",{enumerable:!0,get:function(){return s.print}}),Object.defineProperty(n,"registerBackButtonHandler",{enumerable:!0,get:function(){return s.registerBackButtonHandler}}),Object.defineProperty(n,"registerBeforeUnloadHandler",{enumerable:!0,get:function(){return s.registerBeforeUnloadHandler}}),Object.defineProperty(n,"registerChangeSettingsHandler",{enumerable:!0,get:function(){return s.registerChangeSettingsHandler}}),Object.defineProperty(n,"registerFullScreenHandler",{enumerable:!0,get:function(){return s.registerFullScreenHandler}}),Object.defineProperty(n,"registerOnLoadHandler",{enumerable:!0,get:function(){return s.registerOnLoadHandler}}),Object.defineProperty(n,"registerOnThemeChangeHandler",{enumerable:!0,get:function(){return s.registerOnThemeChangeHandler}}),Object.defineProperty(n,"registerAppButtonClickHandler",{enumerable:!0,get:function(){return s.registerAppButtonClickHandler}}),Object.defineProperty(n,"registerAppButtonHoverEnterHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverEnterHandler}}),Object.defineProperty(n,"registerAppButtonHoverLeaveHandler",{enumerable:!0,get:function(){return s.registerAppButtonHoverLeaveHandler}}),Object.defineProperty(n,"setFrameContext",{enumerable:!0,get:function(){return s.setFrameContext}}),Object.defineProperty(n,"shareDeepLink",{enumerable:!0,get:function(){return s.shareDeepLink}});var l=t(6);Object.defineProperty(n,"returnFocus",{enumerable:!0,get:function(){return l.returnFocus}}),Object.defineProperty(n,"navigateBack",{enumerable:!0,get:function(){return l.navigateBack}}),Object.defineProperty(n,"navigateCrossDomain",{enumerable:!0,get:function(){return l.navigateCrossDomain}}),Object.defineProperty(n,"navigateToTab",{enumerable:!0,get:function(){return l.navigateToTab}});var u=t(10);Object.defineProperty(n,"settings",{enumerable:!0,get:function(){return u.settings}});var d=t(28);Object.defineProperty(n,"tasks",{enumerable:!0,get:function(){return d.tasks}});var c=t(11);Object.defineProperty(n,"ChildAppWindow",{enumerable:!0,get:function(){return c.ChildAppWindow}}),Object.defineProperty(n,"ParentAppWindow",{enumerable:!0,get:function(){return c.ParentAppWindow}});var f=t(12);Object.defineProperty(n,"media",{enumerable:!0,get:function(){return f.media}});var g=t(30);Object.defineProperty(n,"location",{enumerable:!0,get:function(){return g.location}})},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.appInitialization=void 0;var a=t(1),r=t(4);!function(e){e.notifyAppLoaded=function(){a.ensureInitialized(),a.sendMessageRequestToParent("appInitialization.appLoaded",[r.version])},e.notifySuccess=function(){a.ensureInitialized(),a.sendMessageRequestToParent("appInitialization.success",[r.version])},e.notifyFailure=function(e){a.ensureInitialized(),a.sendMessageRequestToParent("appInitialization.failure",[e.reason,e.message])},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(e.FailedReason||(e.FailedReason={}))}(n.appInitialization||(n.appInitialization={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.authentication=void 0;var d=t(1),c=t(0),f=t(2);!function(e){var o,n;function i(){t();try{c.GlobalVars.childWindow&&c.GlobalVars.childWindow.close()}finally{c.GlobalVars.childWindow=null,c.GlobalVars.childOrigin=null}}function a(e){o=e,i();var n=o.width||600,t=o.height||400,n=Math.min(n,c.GlobalVars.currentWindow.outerWidth-400),t=Math.min(t,c.GlobalVars.currentWindow.outerHeight-200),a=document.createElement("a");a.href=o.url;var r=void 0!==c.GlobalVars.currentWindow.screenLeft?c.GlobalVars.currentWindow.screenLeft:c.GlobalVars.currentWindow.screenX,e=void 0!==c.GlobalVars.currentWindow.screenTop?c.GlobalVars.currentWindow.screenTop:c.GlobalVars.currentWindow.screenY;r+=c.GlobalVars.currentWindow.outerWidth/2-n/2,e+=c.GlobalVars.currentWindow.outerHeight/2-t/2,c.GlobalVars.childWindow=c.GlobalVars.currentWindow.open(a.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+e+", left="+r+", width="+n+", height="+t),c.GlobalVars.childWindow?s():l("FailedToOpenWindow")}function t(){n&&(clearInterval(n),n=0),delete c.GlobalVars.handlers.initialize,delete c.GlobalVars.handlers.navigateCrossDomain}function s(){t(),n=c.GlobalVars.currentWindow.setInterval(function(){if(!c.GlobalVars.childWindow||c.GlobalVars.childWindow.closed)l("CancelledByUser");else{var e=c.GlobalVars.childOrigin;try{c.GlobalVars.childOrigin="*",d.sendMessageEventToChild("ping")}finally{c.GlobalVars.childOrigin=e}}},100),c.GlobalVars.handlers.initialize=function(){return[f.FrameContexts.authentication,c.GlobalVars.hostClientType]},c.GlobalVars.handlers.navigateCrossDomain=function(){return!1}}function l(e){try{o&&o.failureCallback&&o.failureCallback(e)}finally{o=null,i()}}function r(e,n,t){var a;e&&((a=document.createElement("a")).href=decodeURIComponent(e),a.host&&a.host!==window.location.host&&"outlook.office.com"===a.host&&-1<a.search.indexOf("client_type=Win32_Outlook")&&(n&&"result"===n&&(t&&(a.href=u(a.href,"result",t)),c.GlobalVars.currentWindow.location.assign(u(a.href,"authSuccess",""))),n&&"reason"===n&&(t&&(a.href=u(a.href,"reason",t)),c.GlobalVars.currentWindow.location.assign(u(a.href,"authFailure","")))))}function u(e,n,t){var a=e.indexOf("#"),r=(r=-1===a?"#":e.substr(a))+"&"+n+(""!==t?"="+t:"");return(e=-1===a?e:e.substr(0,a))+r}c.GlobalVars.handlers["authentication.authenticate.success"]=function(e){try{o&&o.successCallback&&o.successCallback(e)}finally{o=null,i()}},c.GlobalVars.handlers["authentication.authenticate.failure"]=l,e.registerAuthenticationHandlers=function(e){o=e},e.authenticate=function(e){var t=void 0!==e?e:o;d.ensureInitialized(f.FrameContexts.content,f.FrameContexts.sidePanel,f.FrameContexts.settings,f.FrameContexts.remove,f.FrameContexts.task,f.FrameContexts.stage),c.GlobalVars.hostClientType===f.HostClientType.desktop||c.GlobalVars.hostClientType===f.HostClientType.android||c.GlobalVars.hostClientType===f.HostClientType.ios||c.GlobalVars.hostClientType===f.HostClientType.rigel?((e=document.createElement("a")).href=t.url,e=d.sendMessageRequestToParent("authentication.authenticate",[e.href,t.width,t.height]),c.GlobalVars.callbacks[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}):a(t)},e.getAuthToken=function(t){d.ensureInitialized();var e=d.sendMessageRequestToParent("authentication.getAuthToken",[t.resources,t.claims,t.silent]);c.GlobalVars.callbacks[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}},e.getUser=function(t){d.ensureInitialized();var e=d.sendMessageRequestToParent("authentication.getUser");c.GlobalVars.callbacks[e]=function(e,n){e?t.successCallback(n):t.failureCallback(n)}},e.notifySuccess=function(e,n){r(n,"result",e),d.ensureInitialized(f.FrameContexts.authentication),d.sendMessageRequestToParent("authentication.authenticate.success",[e]),d.waitForMessageQueue(c.GlobalVars.parentWindow,function(){return setTimeout(function(){return c.GlobalVars.currentWindow.close()},200)})},e.notifyFailure=function(e,n){r(n,"reason",e),d.ensureInitialized(f.FrameContexts.authentication),d.sendMessageRequestToParent("authentication.authenticate.failure",[e]),d.waitForMessageQueue(c.GlobalVars.parentWindow,function(){return setTimeout(function(){return c.GlobalVars.currentWindow.close()},200)})}}(n.authentication||(n.authentication={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.initializeWithFrameContext=n.setFrameContext=n.executeDeepLink=n.shareDeepLink=n.getMruTabInstances=n.getTabInstances=n.registerChangeSettingsHandler=n.registerBeforeUnloadHandler=n.registerOnLoadHandler=n.registerBackButtonHandler=n.registerAppButtonHoverLeaveHandler=n.registerAppButtonHoverEnterHandler=n.registerAppButtonClickHandler=n.registerFullScreenHandler=n.registerOnThemeChangeHandler=n.getContext=n.print=n.enablePrintCapability=n._uninitialize=n._initialize=n.initialize=void 0;var r=t(1),o=t(0),i=t(4),s=t(10),a=t(3),l=t(9),u=t(2);function d(e,n){if(!o.GlobalVars.initializeCalled){o.GlobalVars.initializeCalled=!0;var t=function(e){return r.processMessage(e)};o.GlobalVars.currentWindow=o.GlobalVars.currentWindow||window,o.GlobalVars.parentWindow=o.GlobalVars.currentWindow.parent!==o.GlobalVars.currentWindow.self?o.GlobalVars.currentWindow.parent:o.GlobalVars.currentWindow.opener,o.GlobalVars.parentWindow?o.GlobalVars.currentWindow.addEventListener("message",t,!1):(o.GlobalVars.isFramelessWindow=!0,window.onNativeMessage=r.handleParentMessage);try{o.GlobalVars.parentOrigin="*";var a=r.sendMessageRequestToParent("initialize",[i.version]);o.GlobalVars.callbacks[a]=function(e,n,t){void 0===t&&(t=i.defaultSDKVersionForCompatCheck),alert("!! setting frame context to GlobalVars: "+JSON.stringify(e)),o.GlobalVars.frameContext=e,o.GlobalVars.hostClientType=n,o.GlobalVars.clientSupportedSDKVersion=t,o.GlobalVars.initializeCallbacks.forEach(function(e){return e()}),o.GlobalVars.initializeCallbacks=[],o.GlobalVars.initializeCompleted=!0}}finally{o.GlobalVars.parentOrigin=null}this._uninitialize=function(){o.GlobalVars.frameContext&&(f(null),g(null),p(null),m(null),b(null),l.logs.registerGetLogHandler(null)),o.GlobalVars.frameContext===u.FrameContexts.settings&&s.settings.registerOnSaveHandler(null),o.GlobalVars.frameContext===u.FrameContexts.remove&&s.settings.registerOnRemoveHandler(null),o.GlobalVars.isFramelessWindow||o.GlobalVars.currentWindow.removeEventListener("message",t,!1),o.GlobalVars.initializeCalled=!1,o.GlobalVars.initializeCompleted=!1,o.GlobalVars.initializeCallbacks=[],o.GlobalVars.additionalValidOrigins=[],o.GlobalVars.parentWindow=null,o.GlobalVars.parentOrigin=null,o.GlobalVars.parentMessageQueue=[],o.GlobalVars.childWindow=null,o.GlobalVars.childOrigin=null,o.GlobalVars.childMessageQueue=[],o.GlobalVars.nextMessageId=0,o.GlobalVars.callbacks={},o.GlobalVars.frameContext=null,o.GlobalVars.hostClientType=null,o.GlobalVars.isFramelessWindow=!1}}Array.isArray(n)&&r.processAdditionalValidOrigins(n),e&&(o.GlobalVars.initializeCompleted?e():o.GlobalVars.initializeCallbacks.push(e))}function c(){window.print()}function f(e){r.ensureInitialized(),(o.GlobalVars.themeChangeHandler=e)&&r.sendMessageRequestToParent("registerHandler",["themeChange"])}function g(e){r.ensureInitialized(),(o.GlobalVars.fullScreenChangeHandler=e)&&r.sendMessageRequestToParent("registerHandler",["fullScreen"])}function p(e){r.ensureInitialized(),(o.GlobalVars.backButtonPressHandler=e)&&r.sendMessageRequestToParent("registerHandler",["backButton"])}function b(e){r.ensureInitialized(),(o.GlobalVars.loadHandler=e)&&r.sendMessageRequestToParent("registerHandler",["load"])}function m(e){r.ensureInitialized(),(o.GlobalVars.beforeUnloadHandler=e)&&r.sendMessageRequestToParent("registerHandler",["beforeUnload"])}function h(e){r.ensureInitialized(u.FrameContexts.content),r.sendMessageRequestToParent("setFrameContext",[e])}n.initialize=d,n._initialize=function(e){o.GlobalVars.currentWindow=e},n._uninitialize=function(){},n.enablePrintCapability=function(){o.GlobalVars.printCapabilityEnabled||(o.GlobalVars.printCapabilityEnabled=!0,r.ensureInitialized(),document.addEventListener("keydown",function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(c(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())}))},n.print=c,n.getContext=function(n){r.ensureInitialized();var e=r.sendMessageRequestToParent("getContext");o.GlobalVars.callbacks[e]=function(e){alert("!! getContext for frameContext: "+JSON.stringify(e.frameContext)),e.frameContext||(alert("!! frame context is empty. Setting to: "+JSON.stringify(o.GlobalVars.frameContext)),e.frameContext=o.GlobalVars.frameContext),n(e)}},n.registerOnThemeChangeHandler=f,n.registerFullScreenHandler=g,n.registerAppButtonClickHandler=function(e){r.ensureInitialized(u.FrameContexts.content),(o.GlobalVars.appButtonClickHandler=e)&&r.sendMessageRequestToParent("registerHandler",["appButtonClick"])},n.registerAppButtonHoverEnterHandler=function(e){r.ensureInitialized(u.FrameContexts.content),(o.GlobalVars.appButtonHoverEnterHandler=e)&&r.sendMessageRequestToParent("registerHandler",["appButtonHoverEnter"])},n.registerAppButtonHoverLeaveHandler=function(e){r.ensureInitialized(u.FrameContexts.content),(o.GlobalVars.appButtonHoverLeaveHandler=e)&&r.sendMessageRequestToParent("registerHandler",["appButtonHoverLeave"])},n.registerBackButtonHandler=p,n.registerOnLoadHandler=b,n.registerBeforeUnloadHandler=m,n.registerChangeSettingsHandler=function(e){r.ensureInitialized(u.FrameContexts.content),(o.GlobalVars.changeSettingsHandler=e)&&r.sendMessageRequestToParent("registerHandler",["changeSettings"])},n.getTabInstances=function(e,n){r.ensureInitialized(),n=r.sendMessageRequestToParent("getTabInstances",[n]),o.GlobalVars.callbacks[n]=e},n.getMruTabInstances=function(e,n){r.ensureInitialized(),n=r.sendMessageRequestToParent("getMruTabInstances",[n]),o.GlobalVars.callbacks[n]=e},n.shareDeepLink=function(e){r.ensureInitialized(u.FrameContexts.content,u.FrameContexts.sidePanel),r.sendMessageRequestToParent("shareDeepLink",[e.subEntityId,e.subEntityLabel,e.subEntityWebUrl])},n.executeDeepLink=function(e,n){r.ensureInitialized(u.FrameContexts.content,u.FrameContexts.sidePanel,u.FrameContexts.settings,u.FrameContexts.task,u.FrameContexts.stage),e=r.sendMessageRequestToParent("executeDeepLink",[e]),o.GlobalVars.callbacks[e]=n||a.getGenericOnCompleteHandler()},n.setFrameContext=h,n.initializeWithFrameContext=function(e,n,t){d(n,t),h(e)}},function(e,n,t){"use strict";var a=this&&this.__rest||function(e,n){var t={};for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var a=0,r=Object.getOwnPropertySymbols(e);a<r.length;a++)n.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(t[r[a]]=e[r[a]]);return t};Object.defineProperty(n,"__esModule",{value:!0}),n.tasks=void 0;var r=t(1),o=t(0),i=t(2),s=t(11);!function(e){e.startTask=function(e,n){return r.ensureInitialized(i.FrameContexts.content,i.FrameContexts.sidePanel),e=r.sendMessageRequestToParent("tasks.startTask",[e]),o.GlobalVars.callbacks[e]=n,new s.ChildAppWindow},e.updateTask=function(e){r.ensureInitialized(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.task),e.width,e.height;var n=a(e,["width","height"]);if(Object.keys(n).length)throw new Error("updateTask requires a taskInfo argument containing only width and height");r.sendMessageRequestToParent("tasks.updateTask",[e])},e.submitTask=function(e,n){r.ensureInitialized(i.FrameContexts.content,i.FrameContexts.sidePanel,i.FrameContexts.task),r.sendMessageRequestToParent("tasks.completeTask",[e,Array.isArray(n)?n:[n]])}}(n.tasks||(n.tasks={}))},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.validateViewImagesInput=n.validateGetMediaInputs=n.validateSelectMediaInputs=n.decodeAttachment=n.createFile=void 0;var a=t(12);n.createFile=function(e,n){if(null==e||null==n||e.length<=0)return null;var t,a=1;return e.sort(function(e,n){return e.sequence>n.sequence?1:-1}),e.forEach(function(e){e.sequence==a&&(t=t?new Blob([t,e.file],{type:n}):new Blob([e.file],{type:n}),a++)}),t},n.decodeAttachment=function(e,n){if(null==e||null==n)return null;for(var t=atob(e.chunk),a=new Array(t.length),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);var o=new Uint8Array(a),n=new Blob([o],{type:n});return{sequence:e.chunkSequence,file:n}},n.validateSelectMediaInputs=function(e){return!(null==e||10<e.maxMediaCount)},n.validateGetMediaInputs=function(e,n,t){return null!=e&&null!=n&&n==a.media.FileFormat.ID&&null!=t},n.validateViewImagesInput=function(e){return!(null==e||e.length<=0||10<e.length)}},function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.location=void 0;var a=t(0),r=t(5),o=t(1),i=t(2);!function(t){t.locationAPIsRequiredVersion="1.9.0",t.getLocation=function(e,n){if(!n)throw new Error("[location.getLocation] Callback cannot be null");o.ensureInitialized(i.FrameContexts.content,i.FrameContexts.task),o.isAPISupportedByPlatform(t.locationAPIsRequiredVersion)?e?(e=o.sendMessageRequestToParent("location.getLocation",[e]),a.GlobalVars.callbacks[e]=n):n({errorCode:r.ErrorCode.INVALID_ARGUMENTS},void 0):n({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)},t.showLocation=function(e,n){if(!n)throw new Error("[location.showLocation] Callback cannot be null");o.ensureInitialized(i.FrameContexts.content,i.FrameContexts.task),o.isAPISupportedByPlatform(t.locationAPIsRequiredVersion)?e?(e=o.sendMessageRequestToParent("location.showLocation",[e]),a.GlobalVars.callbacks[e]=n):n({errorCode:r.ErrorCode.INVALID_ARGUMENTS},void 0):n({errorCode:r.ErrorCode.OLD_PLATFORM},void 0)}}(n.location||(n.location={}))}])});